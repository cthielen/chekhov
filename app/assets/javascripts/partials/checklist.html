<div class="alert alert-success affix" style="bottom: 0; right: 15px;" ng-show="saved">
  <strong>{{saved}}</strong>
</div>

<div class="row" ng-show="loaded" style="margin-top: 2em;">
  <p class="text-info col-md-10">Using checklist '{{ checklist.template_name }}'</h4>
  <h1 class="col-md-12">
    {{ checklist.name }}
    <span class="pull-right badge" id="completed-badge" ng-show="checklist.finished">
      Completed: {{ checklist.finished | date:'short' }}</span>
  </h1>
</div>

<div class="row" ng-show="loaded" style="margin-top: 25px;">
  <div class="col-md-4 col-md-offset-2">
    <div class="input-group">
      <span class="input-group-addon">SysAid Ticket #</span>
      <input type="number" class="form-control" ng-model="checklist.ticket_number" placeholder="SysAid Ticket #"
        on-blur="setTicketNumber()" on-enter="saveChanges()"></input>
    </div>
  </div>
  <div class="col-md-6">
    <div class="btn-group pull-right" ng-show="user.is_admin || user.id == checklist.user_id">
        <button type="button" class="btn btn-info" ng-model="checklist.public" btn-radio="true" ng-click="togglePublic()">Public</button>
        <button type="button" class="btn btn-info" ng-model="checklist.public" btn-radio="false" ng-click="togglePublic()">Not Public</button>
    </div>
  </div>
</div>

<div class="row" style="margin-top: 2em;">
  <div class="col-md-10 col-md-offset-2">
    <div class="alert alert-error" ng-show="error">
      <button type="button" class="close" ng-click="clearError()">&times;</button>
      <div ng-bind-html="error"></div>
    </div>

    <div class="row text-center" ng-hide="loaded" id="loading"><img src="assets/ajax-loader.gif"></div>
    <table class="table table-hover" id="entries" ng-show="loaded">
      <tbody>
        <tr ng-repeat="entry in checklist.entries_attributes"
          popover-template="/assets/partials/time_spent.html"
          popover-placement="left"
          popover-trigger="{{{true: 'click', false: 'never'}[displayTimeSpent(entry)]}}"
          ng-click="check(entry)">
          <td class="col-xs-1">
            <input type="checkbox" ng-model="entry.checked"  ></input>
          </td>
          <td><span class="pull-right" style="padding-top: 1.5em; color: #aaa; font-size: 0.8em; padding-right: 3em;">{{entry.user_name}}<br />{{entry.finished | date:'short'}}</span><h3>{{$index+1}}. {{ entry.content }}</h3></td>
        </tr>
        <tr class="active" ng-show="checklist.comments_attributes">
          <td colspan="2">
            <h3>Comments:</h3>
          </td>
        </tr>
        <tr ng-repeat="comment in checklist.comments_attributes" class="active">
          <td colspan="2">
            <blockquote>
              <p ng-bind-html="comment.content | newlines"></p>
              <small>{{comment.author}} <cite>{{comment.created_at | date:'short'}}</cite></small>
            </blockquote>
        </tr>
        <tr>
          <td colspan="2">
            <form class="form-horizontal">
              <div class="form-group">
                <label for="comments" class="col-sm-2 control-label text-muted">Add comment</label>
                <div class="col-sm-10">
                  <textarea class="form-control" ng-model="newComment"></textarea>
                  <span class="help-inline">{{SysAidError}}</span>
                </div>
              </div>
              <div class="form-group">
                <div class="col-sm-offset-2 col-sm-10">
                  <button type="submit" class="btn btn-default" ng-click="saveChanges()">Comment</button>
                </div>
              </div>
            </form>
          </td>
        </tr>
      </tbody>
    </table>
    
  </div>
</div>
